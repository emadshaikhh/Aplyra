<div class="page-wrapper">
  
  <div class="mobile-backdrop" 
       [class.active]="showMobileFilters" 
       (click)="closeFilters()">
  </div>

  <div class="container">
    
    <div class="layout-flex">
      
      <aside class="sidebar desktop-only">
        <div class="sidebar-header">
          <h3>Filters</h3>
          <button class="reset-btn" (click)="resetFilters()">Reset</button>
        </div>
        
        <ng-container *ngTemplateOutlet="filterContent"></ng-container>
      </aside>

      <main class="main-content">
        
        <h1 class="page-title">{{ pageTitle }}</h1>

        <div class="pro-search-bar">
          <span class="search-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#64748b" stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle>
              <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </svg>
          </span>
          
          <input 
            type="text" 
            [placeholder]="searchPlaceholder" 
            (keyup)="onSearch($any($event.target).value)"
          >
          
          <button class="search-action-btn">Search</button>
        </div>

        <div class="mobile-filter-row">
          <button class="text-filter-btn" (click)="toggleFilters()">
            <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path></svg>
            Filter & Sort
          </button>
        </div>

        <div class="results-meta">
          <span>Showing <strong>{{ filteredScholarships.length }}</strong> opportunities</span>
        </div>

        <div class="scholarships-grid">
          <div *ngIf="isLoading" class="loading-state">
            <div class="spinner"></div>
            <p>Finding opportunities...</p>
          </div>

          <div *ngIf="!isLoading && filteredScholarships.length === 0" class="empty-state">
            <p>No opportunities found matching your criteria.</p>
            <button (click)="resetFilters()">Clear Filters</button>
          </div>

          <app-scholarship-card
            *ngFor="let scholarship of filteredScholarships"
            [scholarship]="scholarship"
            [viewMode]="'grid'"
            [showCategory]="!filters.category">
          </app-scholarship-card>
        </div>

      </main>

    </div> 
  </div>

  <aside class="sidebar mobile-drawer" [class.open]="showMobileFilters">
  <div class="sidebar-header">
    <h3>Filters</h3>
    <button class="close-drawer-btn" (click)="closeFilters()">âœ•</button>
  </div>
  
  <div class="sidebar-scroll-content">
      <button class="reset-btn-mobile" (click)="resetFilters()">Reset All</button>
      <ng-container *ngTemplateOutlet="filterContent"></ng-container>
  </div>

  <div class="drawer-footer">
    <button class="apply-btn" (click)="applyFilters()">Apply Filters</button>
  </div>
</aside>

</div>

<ng-template #filterContent>
  
  <div *ngIf="pageType === 'scholarships'">
    <div class="filter-group">
      <h4>Education Level</h4>
      <label class="checkbox-row" *ngFor="let level of scholarshipClassOptions">
        <input type="checkbox" 
               [checked]="filters.course.includes(level)" 
               (change)="updateFilter('course', level)">
        <span class="custom-checkbox"></span>
        <span class="label-text">{{ level }}</span>
      </label>
    </div>

    <div class="filter-group">
      <h4>Location</h4>
      <label class="checkbox-row" *ngFor="let state of stateOptions">
        <input type="checkbox" 
               [checked]="filters.state.includes(state)"
               (change)="updateFilter('state', state)">
        <span class="custom-checkbox"></span>
        <span class="label-text">{{ state }}</span>
      </label>
    </div>
  </div>

  <div *ngIf="pageType === 'internships'">
    <div class="filter-group">
      <h4>Job Profile</h4>
      <label class="checkbox-row" *ngFor="let role of internshipRoles">
        <input type="checkbox" 
               [checked]="filters.course.includes(role)" 
               (change)="updateFilter('course', role)">
        <span class="custom-checkbox"></span>
        <span class="label-text">{{ role }}</span>
      </label>
    </div>

    <div class="filter-group">
      <h4>Duration / Type</h4>
      <label class="checkbox-row" *ngFor="let type of internshipDuration">
        <input type="checkbox" 
               [checked]="filters.state.includes(type)"
               (change)="updateFilter('state', type)">
        <span class="custom-checkbox"></span>
        <span class="label-text">{{ type }}</span>
      </label>
    </div>
  </div>

  <div *ngIf="pageType === 'schemes'">
    <div class="filter-group">
      <h4>Income Group</h4>
      <label class="checkbox-row" *ngFor="let income of schemeIncomeGroups">
        <input type="checkbox" 
               [checked]="filters.course.includes(income)" 
               (change)="updateFilter('course', income)">
        <span class="custom-checkbox"></span>
        <span class="label-text">{{ income }}</span>
      </label>
    </div>

    <div class="filter-group">
      <h4>Category (Caste/Gender)</h4>
      <label class="checkbox-row" *ngFor="let cat of schemeCategories">
        <input type="checkbox" 
               [checked]="filters.category === cat"
               (change)="filters.category = cat; applyFilters()"> 
               <span class="custom-checkbox"></span>
        <span class="label-text">{{ cat }}</span>
      </label>
    </div>

    <div class="filter-group">
      <h4>State</h4>
      <label class="checkbox-row" *ngFor="let state of stateOptions">
        <input type="checkbox" 
               [checked]="filters.state.includes(state)"
               (change)="updateFilter('state', state)">
        <span class="custom-checkbox"></span>
        <span class="label-text">{{ state }}</span>
      </label>
    </div>
  </div>

</ng-template>